\documentclass[12pt]{article}
\usepackage[UTF8]{ctex}
\usepackage{amsmath, amssymb, amsfonts}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{listings}
\usepackage{xcolor}
\usepackage[colorlinks, linkcolor=blue, citecolor=blue, urlcolor=blue]{hyperref}
\usepackage{bookmark}
\usepackage{tabularx} % 用于自适应表格宽度
\usepackage{float}
\usepackage[titletoc]{appendix} % 添加appendix宏包
\usepackage[nottoc]{tocbibind} % 添加参考文献到目录中
% Define \upcite for compatibility

\newcommand{\upcite}[1]{\textsuperscript{\cite{#1}}}
\usepackage{geometry}
\geometry{left=2.5cm, right=2.5cm, top=2.5cm, bottom=2.5cm}
\lstset{
    basicstyle=\ttfamily\small,
    commentstyle=\color{gray},
    keywordstyle=\color{blue},
    stringstyle=\color{red},
    breaklines=true,
    frame=single,
    numbers=left,
    numberstyle=\tiny\color{gray},
    tabsize=4
}


\begin{document}

\begin{titlepage}
    \begin{center}
        \vspace*{1cm}
        
        
        \vspace{1cm}
        \includegraphics[width=\textwidth]{} % 替换为学校徽标路径
\vspace{1cm}

        \Huge
        \textbf{上机报告}

        \vspace{0.5cm}
        \LARGE
        \textbf{课程名称：}
        \textbf{《 》}

        \vfill

        \Large
        \begin{tabbing}
            \centering
        姓名：\quad \=  \\
        学号：\>  \\
        专业：\>  \\
        %班级：\> [在此填写班级] \\
        日期：\> \today
        \end{tabbing}
    \end{center}
\end{titlepage}
\newpage
\pagenumbering{Roman}
\renewcommand{\contentsname}{}
\begin{center}
    \heiti \zihao{3} 目录 \\[1em]
\end{center}
\tableofcontents
\newpage

\pagenumbering{arabic}
\section{问题重述}
\subsection{问题描述}

\subsection{问题分析}
题目要求我们完成如下目标：

\section{符号说明}
\begin{table}[H]
    \centering
    \caption{符号说明表}
    \label{tab:symbols}
    \begin{tabularx}{\textwidth}{>{\centering\hsize=0.3\hsize}X >{\hsize=0.7\hsize}X}
        \toprule
        \textbf{符号} & \textbf{含义} \\
        \midrule
        $X_n$ & 第n步时象的位置 \\
        $P$ & 转移概率矩阵 \\
        \bottomrule
    \end{tabularx}
\end{table}

\section{第一问求解}
\subsection{数值计算}
\subsection{结论}

\section{第二问求解}


\section{第三问求解}
\subsection{理论背景}
\subsection{实验设计}
\subsection{收敛过程}
\subsection{实验结果}

\begin{thebibliography}{99}
        \bibitem{刘海洋2013latex}
        刘海洋.
        \newblock {\LaTeX{} 入门}.
        \newblock 电子工业出版社, 北京, 2013.
    \end{thebibliography}

\newpage

\begin{appendices}   
\section{文件清单}
\begin{table}[htbp]
    \centering
    \caption{文件清单}
    \label{tab:files}
    \begin{tabular}{cccc}
        \toprule
        序号 & 文件名 & 类型 & 用途 \\
        \midrule
        1 & pai.py & Python & 计算 \\
        2 & sim.py & Python & 模拟 \\
        3 & plot1.py & Python & 绘制 \\
        4 & plot2.py & Python & 绘制 \\
        5 & average.py & Python & 绘制 \\
        \bottomrule
    \end{tabular}
\end{table}

\section{\texttt{pai.py} 文件}
\begin{lstlisting}[language=Python,caption=pai.py]
\end{lstlisting}

\section{\texttt{plot1.py} 文件}
\begin{lstlisting}[language=Python,caption=plot1.py]
\end{lstlisting}

\section{\texttt{plot2.py} 文件}
\begin{lstlisting}[language=Python,caption=plot2.py]
\end{lstlisting}

\section{\texttt{average.py} 文件}
\begin{lstlisting}[language=Python,caption=average.py]
\end{lstlisting}

\end{appendices}
\end{document}
